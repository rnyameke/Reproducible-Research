---
title: "PA2_Rep_Research"
author: "Rose Nyameke"
date: "November 19, 2015"
output: 
  html_document: 
    keep_md: yes
---

##Top 10 storms from 1950-2011
Using data from the NOAA Storm database, I explore the impact of storms and other
natural disasters on the health of the population, as well as the economic impact of
storms. By isolating the 10 worst events in each category. To examine the economic
impact, I selected the . I found that .

##Data Processing
````{r load data and libraries, message = FALSE, cache = TRUE}
#url <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2"
#download.file(url, destfile = "event_data.csv.bz2", method = "curl")
data <- read.csv("event_data.csv.bz2")
library(dplyr)
library(ggplot2)
````

###Which types of events are most harmful with respect to population health?
````{r health_implication, cache = TRUE}
# selecting top 10 events with highest fatalities and injuries (combined)

# subsetting evtype, injuries and fatalities columns
health_imp <- subset(data, select = c(EVTYPE, INJURIES, FATALITIES))
     
#group by event type
health_imp <- group_by(health_imp, EVTYPE)

#sum of fatalities and injuries by event
health_imp <- summarize(health_imp, sum(INJURIES), sum(FATALITIES))

#rename columns
names(health_imp) <- c("evtype", "injuries", "fatalities")

# creating the column to hold the total of injuries and fatalities
health_imp$total <- health_imp$injuries + health_imp$fatalities

#order the data frame by total column & select the top 10
health_imp <- health_imp[order(-health_imp$total), ]
top_health_imp <- health_imp[1:10, ]

#comparing the numbers
health_graph <- ggplot(data = top_health_imp, aes(x = evtype, y = total)) + geom_bar(stat = "identity") + xlab("Event Type") + ylab("Fatalities and Injuries")
````

###Which events have the most economic impact
````{r economic_consequence, cache = TRUE}
#selecting only the evtype, crop damage and property damage columns (plus their exponents)
prop_data <- subset(data, select = c(EVTYPE, PROPDMG, PROPDMGEXP))
crop_data <- subset(data, select = c(EVTYPE, CROPDMG, CROPDMGEXP))
     
#group by event type and exponents
prop_data <- group_by(prop_data, EVTYPE, PROPDMGEXP)
crop_data <- group_by(crop_data, EVTYPE, CROPDMGEXP)

#sum of property and crop damage by event, keeping separate by exp
prop_summary <- summarize(prop_data, sum(PROPDMG))
crop_summary <- summarize(crop_data, sum(CROPDMG))

#rename columns
names(prop_summary) <- c("evtype", "propdmgexp", "propdmg")
names(crop_summary) <- c("evtype", "cropdmgexp", "cropdmg")
````
Upon inspection, the top 5 in each category will be in billions. I therefore decided to
select the rows that recorded property or crop damage in billions.

````{r, cache = FALSE}
prop_dmg <- subset(prop_summary, propdmgexp == "B")
crop_dmg <- subset(crop_summary, cropdmgexp == "B")
````

##Results
The events that had the biggest effect on population health, as determined by the
total number of injuries and fatalities are shown below:
````{r}
par(mfrow = c(1, 2))
print(top_health_imp)
print(health_graph)
````
**Figure 1: events with the biggest effect on population health**

Within the top ten events, tornadoes had significantly larger effects on population health
than the other events.

The events that had the biggest economic impact:
````{r}
print(top_econ)
print(econ_graph)
````
**Figure 2: events with the biggest economic effect**